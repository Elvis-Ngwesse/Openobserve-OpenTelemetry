<!DOCTYPE html>
<html>
<head>
    <title>Cyber Threat Intelligence</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-5">
    <h1 class="mb-4">Recent Threats</h1>
    <form method="get" class="row g-3">
        <div class="col-md-4">
            <input
                    name="type"
                    class="form-control"
                    placeholder="Threat Type (e.g., malware)"
                    value="{{ request.args.get('type', '') }}">
        </div>
        <div class="col-md-4">
            <input
                    name="severity"
                    class="form-control"
                    placeholder="Severity (e.g., high)"
                    value="{{ request.args.get('severity', '') }}">
        </div>
        <div class="col-md-4">
            <button class="btn btn-primary w-100" type="submit">Filter</button>
        </div>
    </form>

    <table class="table table-hover table-bordered mt-4">
        <thead class="table-dark">
        <tr>
            <th>Timestamp</th>
            <th>Indicator</th>
            <th>Type</th>
            <th>Severity</th>
        </tr>
        </thead>
        <tbody>
        {% for t in threats %}
        <tr>
            <td>{{ t.timestamp.strftime('%Y-%m-%d %H:%M:%S') if t.timestamp else 'N/A' }}</td>
            <td>{{ t.indicator }}</td>
            <td>{{ t.type }}</td>
            <td>{{ t.severity }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="4" class="text-center">No threats found</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>
